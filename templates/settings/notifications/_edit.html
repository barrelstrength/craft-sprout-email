{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% if campaign is defined %}
	{% set title = "Edit Notification" %}
	{% set campaignId = campaign.id %}
{% else %}
	{% set title = "Edit Notification" %}
	{% set campaign = craft.sproutEmail.getCampaignById(campaignId) %}
	{% set campaignId = campaign.id %}	
{% endif %}

{% set crumbs = [
  { label: "Sprout Email"|t, url: url('sproutemail') },
  { label: "Settings"|t, url: url('sproutemail/settings') },
] %}

{% set content %}

  <form method="post" action="" accept-charset="UTF-8" data-saveshortcut data-saveshortcut-redirect="{{ url('sproutemail/settings/notifications/edit/{id}') }}">
    <input type="hidden" name="action" value="sproutEmail/entry/saveEntry">
    <input type="hidden" name="redirect" value="sproutemail/entries/edit/{id}">
    <input type="hidden" name="continue" value="false">
    <input type="hidden" name="tab" value="fields">

    <input type="hidden" name="sproutEmail[id]" value="{{ campaignId }}">
    <input type="hidden" name="sproutEmail[emailProvider]" value="SproutEmail">

    <input type="hidden" name="sproutEmail[type]" value="notification">
    
    <div id="tab-campaign-info" class="tab-content" >

      {{ forms.textField({
        label: "Notification Name"|t,
        id: 'name',
        name: 'sproutEmail[name]',
        instructions: "Human readable notification name"|t,
        value: (campaign is defined ? campaign.name : null),
        autofocus: true,
        required: true,
        errors: (campaign is defined ? campaign.getErrors('name') : null)   
      }) }}

      {% include "_includes/fieldlayoutdesigner" with {
        fieldLayout: campaign.getFieldLayout()
      } only %}

    </div>
    
    <div class="buttons">
      <input class="btn" type="submit" value="Save Notification Info">
      <input class="btn submit save-and-continue" id="info" type="button" value="Save Notification Info & Continue">
    </div>
  </form>

{% endset %}

{% includeJsResource "sproutemail/js/sproutemail.js" %}