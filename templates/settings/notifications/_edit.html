{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% set title = "Edit Notification"|t %}
{% set campaign = craft.sproutEmail.getCampaignById(campaignId) %}

{% set crumbs = [
	{ label: "Sprout Email", url: url('sproutemail') },
	{ label: "Settings"|t, url: url('sproutemail/settings') },
] %}

{% set content %}

		<form method="post" action="" accept-charset="UTF-8" data-saveshortcut data-saveshortcut-redirect="{{ url('sproutemail/settings/notifications/edit/{id}') }}">
		<input type="hidden" name="action" value="sproutEmail/campaign/saveCampaign">
		<input type="hidden" name="redirect" value="sproutemail/settings/notifications/edit/{id}">
		<input type="hidden" name="tab" value="fields">
		<input type="hidden" name="sproutEmail[id]" value="{{ campaignId }}">
		<input type="hidden" name="sproutEmail[mailer]" value="defaultmailer">
		<input type="hidden" name="sproutEmail[type]" value="notification">

		{{ getCsrfInput() }}

		<div id="tab-campaign-info" class="tab-content" >

			{{ forms.textField({
				label: "Notification Name"|t,
				id: 'name',
				name: 'sproutEmail[name]',
				instructions: "Human readable notification name"|t,
				value: (campaign is defined ? campaign.name : null),
				autofocus: true,
				required: true,
				errors: (campaign is defined ? campaign.getErrors('name') : null)
			}) }}

			{{ forms.textField({
				label: "Entry Template"|t,
				id: 'template',
				name: 'sproutEmail[template]',
				instructions: "The template to use when an Entry's URL is requested.  The text version of the Email will use the same template name and append .txt"|t,
				placeholder: 'email/_emailtemplate',
				value: (campaign is defined ? campaign.template : null),
				errors: (campaign is defined ? campaign.getErrors('template') : null)
			}) }}
		</div>

		<hr>

		{% include "_includes/fieldlayoutdesigner" with {fieldLayout: campaign.getFieldLayout() } only %}

		<div class="buttons">

			<div class="btngroup submit first">
				<input type="submit" class="btn submit" value="{{ 'Save'|t }}">

				<div class="btn submit menubtn"></div>
				<div class="menu">
					<ul>
						<li><a class="formsubmit" data-redirect="sproutemail/settings/notifications/edit/{id}">{{ "Save and continue editing"|t }}</a></li>
						<li><a class="formsubmit" data-redirect="sproutemail/entries/edit/{entryId}">{{ "Save and edit notification email"|t }}</a></li>
					</ul>
				</div>
			</div>
		</div>

	</form>

{% endset %}

{% includeJsResource "sproutemail/js/sproutemail.js" %}
