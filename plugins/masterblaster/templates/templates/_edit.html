{% extends "_layouts/cp" %}
{% import "_includes/forms" as forms %}

{% if craft.request.getSegment('3') == 'new' %}
	{% set title = "New Form" %}
{% else %}
	{% set title = "Edit Form" %}
{% endif %}

{% set crumbs = [
	{ label: "Se√±or Form"|t, url: url('senorform/forms') },
] %}

{% set tabs = {
    general: { 
      label: "General Info"|t,
      url: '#tab-general-info'
    },
    blocks:    { 
      label: "Fields"|t,
      url: '#tab-fields'
    },
    notifications:    { 
      label: "Notifications"|t,
      url: '#tab-notification'
    },
    settings:    { 
      label: "Settings"|t,
      url: '#tab-settings'
    }
} %}

{% if formId is not defined %}
	{% set formId = null %}
{% endif %}

{% set form = craft.senorForm.getFormById(formId) %}

{% set content %}

<form method="post" action="" accept-charset="UTF-8">
	<input type="hidden" name="action" value="senorForm/settings/saveForm">
	<input type="hidden" name="redirect" value="senorform/forms">

	<input type="hidden" name="id" value="{{ formId }}">

<div id="tab-general-info">
	
	{{ forms.textField({
		label: "Form Name"|t,
		id: 'formName',
		name: 'formName',
		instructions: "Human readable form name"|t,
		value: (form is defined ? form.name : null),
		autofocus: true,
		required: true,
		errors: (form is defined ? form.getErrors('name') : null) 	
	}) }}

	{{ forms.textField({
		label: "Form Handle"|t,
		id: 'formHandle',
		name: 'formHandle',
		instructions: "Short name you will use to refer to your form in the code"|t,
		value: (form is defined ? form.handle : null),
		required: true,
		errors: (form is defined ? form.getErrors('handle') : null) 	
	}) }}
	
</div>

<div id="tab-fields" class="hidden">
	
	<p>Add any number of Fields to your form.  Might have to manage this on a separate top level tab to make saving easier.</p>

		<table id="fields" class="data collapsible">
		<thead>
			<th scope="col">{{ "Name"|t }}</th>
			<th scope="col">{{ "Handle"|t }}</th>
			<th scope="col">{{ "Type"|t }}</th>
			<td class="thin"></td>
		</thead>
		<tbody>
			{% for i in 1..5 %}
				<tr data-id="" data-name="">
					<th scope="row" data-title=""><a href="{{ url('settings/fields/edit/') }}">Field Name</a>
						<span class="required"></span>
					</th>
					<td data-title="{{ 'Handle'|t }}"><code>shortName</code></td>
					<td data-title="{{ 'Type'|t }}">Field Type
					</td>
					<td class="thin"><a class="delete icon" title="{{ 'Delete'|t }}"></a></td>
				</tr>
				{#<tr data-id="{{ field.id }}" data-name="{{ field.name|t }}">
					<th scope="row" data-title="{{ 'Name'|t }}"><a href="{{ url('settings/fields/edit/' ~ field.id) }}">{{ field.name|t }}</a>
						{%- if field.required %} <span class="required"></span>{% endif -%}
					</th>
					<td data-title="{{ 'Handle'|t }}"><code>{{ field.handle }}</code></td>
					<td data-title="{{ 'Type'|t }}">
						{% set fieldType = craft.fields.populateFieldType(field) %}
						{% if fieldType %}
							{{ fieldType.name }}
						{% else %}
							<span class="error">{{ field.type }}</span>
						{% endif %}
					</td>
					<td class="thin"><a class="delete icon" title="{{ 'Delete'|t }}"></a></td>
				</tr>#}
			{% endfor %}
		</tbody>
	</table>

</div>

<div id="tab-notification" class="hidden">
	
	<p>Check for Master Blaster.  Install if necessary.</p>

	<p>Create a field type with a drop down of template options from Master Blaster.</p>

	<p>Allow each Email Template to tie to a hook, and trigger based on some name. Multiple notifications can be added.</p>

	<ul>
		<li>Admin Notification</li>
		<li>User Notification</li>
		<li>Others?  Or just keep this simple?</li>
	</ul>


</div>

<div id="tab-settings" class="hidden">
	
	<p>Customize Form Settings here.</p>

</div>


<div class="buttons">
	<input class="btn submit" type="submit" value="Save Template">
</div>

</form>

{% endset %}